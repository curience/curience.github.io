define(["./config","./profile"],function(e,a){return{searchForm:$(".search-form"),searchOpen:!1,searchOnType:function(){var s=this;$(window).keypress(function(r){(r.charCode>96&&r.charCode<123||r.which>96&&r.which<123||r.keyCode>96&&r.keyCode<123)&&0===$("input:focus").length&&0===$("textarea:focus").length&&($(".full-page-search").focus(),e.winH=$(window).height(),s.searchOpen||e.moduleOpen||a.editingList||a.editingName||($(".search-full-page").height(e.winH).fadeIn(),$(".search-full-page").addClass("open"),s.searchForm=$(".search-full-page .search-form"),s.searchForm.find('input[name="search-term"]').focus(),$("body").addClass("locked"),s.searchOpen=!0,(r.shiftKey&&35==r.charCode||35==r.keyCode||35==r.which)&&(r.preventDefault(),s.changeSearchTypeToTag(r)),(r.shiftKey&&64==r.charCode||64==r.keyCode||64==r.which)&&(r.preventDefault(),s.changeSearchTypeToUser(r)),s.closeSearchOnESC()))}),$(window).keypress(function(e){(e.shiftKey&&35==e.charCode||35==e.keyCode||35==e.which)&&s.changeSearchTypeToTag(e),(e.shiftKey&&64==e.charCode||64==e.keyCode||64==e.which)&&s.changeSearchTypeToUser(e)}),$(".symbol.tag-search").on("click",function(e){e.preventDefault(),s.changeSearchTypeToTag(e)}),$(".symbol.user-search").on("click",function(e){e.preventDefault(),s.changeSearchTypeToUser(e)}),s.searchForm.submit(function(e){s.submitSearchForm(e)})},searchInNav:function(){var e=this;$(".nav-search").focus(function(){e.searchForm=$(".main-nav .search-form")}),$(".nav-search").keypress(function(a){(a.shiftKey&&35==a.charCode||35==a.keyCode||35==a.which)&&e.changeSearchTypeToTag(a),(a.shiftKey&&64==a.charCode||64==a.keyCode||64==a.which)&&e.changeSearchTypeToUser(a)}),$(".nav-search").change(function(a){var s=$(this).val();console.log(a),0===s.indexOf("@")?e.changeSearchTypeToUser(a):0===s.indexOf("#")&&e.changeSearchTypeToTag(a)}),$(".main-nav .search-form").submit(function(a){e.submitSearchForm(a)})},searchOnClick:function(){var s=this;$("body").on("click",".new-search",function(r){r.preventDefault(),0===$("input:focus").length&&($(".full-page-search").focus(),e.winH=$(window).height(),s.searchOpen||e.moduleOpen||a.editingList||a.editingName?s.closeSearch():($(".search-full-page").height(e.winH).fadeIn(),$(".search-full-page").addClass("open"),s.searchForm=$(".search-full-page .search-form"),s.searchForm.find('input[name="search-term"]').focus(),$("body").addClass("locked"),s.searchOpen=!0,$(this).hasClass("search-users")?s.changeSearchTypeToUser(r):s.changeSearchTypeToTag(r),s.closeSearchOnESC()))})},changeSearchTypeToTag:function(a){var s=this;if(s.searchForm.hasClass("user-search")){var r=e.baseUrl+"/search";s.searchForm.removeClass("user-search").addClass("tag-search"),s.searchForm.find(".symbol").length>0&&(a.preventDefault(),s.searchForm.find(".symbol.tag-search").addClass("active"),s.searchForm.find(".symbol.user-search").removeClass("active")),s.searchForm.attr("action",r)}},changeSearchTypeToUser:function(a){var s=this;if(s.searchForm.hasClass("tag-search")){var r=e.baseUrl+"/search/users";s.searchForm.removeClass("tag-search").addClass("user-search"),s.searchForm.find(".symbol").length>0&&(a.preventDefault(),s.searchForm.find(".symbol.user-search").addClass("active"),s.searchForm.find(".symbol.tag-search").removeClass("active")),s.searchForm.attr("action",r)}},submitSearchForm:function(e){var a=this;if(a.searchForm.hasClass("tag-search")){var s=/[!@\$%\^&\*\(\)\+\-_=\{\[\}\]\"\'\:\;\.,\?\|\/]/g,r=s.test(a.searchForm.find('input[name="search-term"]').val());r?(e.preventDefault(),a.searchForm.find(".search-error").html("<em>Please remove any special characters from your search.</em>").show()):""===a.searchForm.find('input[name="search-term"]').val()&&(e.preventDefault(),a.searchForm.find(".search-error").html("<em>Please enter a tag to search.</em>").show())}else a.searchForm.hasClass("user-search")&&""===a.searchForm.find('input[name="search-term"]').val()&&(e.preventDefault(),a.searchForm.find(".search-error").html("<em>Please enter a user's name to search.</em>").show())},searchSuggestions:function(){var e=this;$(window).on("keyup",function(){var a=e.searchForm.find(".full-page-search").val(),s={type:"tag",match:"after",count:10,query:a};e.searchForm.hasClass("tag-search")&&a.length>3?$.ajax({url:"//api.hshtags.com/v1/search",data:s,success:function(a){a.data.length>0&&e.searchForm.find(".search-suggestions").addClass("filled"),e.searchForm.find(".search-suggestions ul").empty(),$.each(a.data,function(a,s){e.searchForm.find(".search-suggestions ul").append('<li><a href="/tags/v/'+s.hashtag+'">'+s.hashtag+"</a></li>"),console.log(s.hashtag)})},error:function(){}}):(e.searchForm.find(".search-suggestions ul").empty(),e.searchForm.find(".search-suggestions").removeClass("filled"))})},closeSearchOnESC:function(){var e=this;$(document).keyup(function(a){(27==a.keyCode||27==a.which)&&e.closeSearch()})},closeSearch:function(){var e=this;e.searchOpen&&($('input[name="search-term"]').val(""),$(".search-full-page").fadeOut("1000"),$(".search-error").html("").hide(),$("body").removeClass("locked"),e.searchOpen=!1)},init:function(){this.searchOnType(),this.searchInNav(),this.searchOnClick(),this.searchSuggestions()}}});