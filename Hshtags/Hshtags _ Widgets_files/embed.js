"use strict";function sortPosts(t,a){var e=[],o=[];if(angular.forEach(t,function(t,a){var o=[];o.push("id_"+t.post_id.toString()),o.push(t.post_time),e[a]=o}),a)var s=e.sort(function(t,a){return a[1]-t[1]});else var s=e.sort(function(t,a){return t[1]-a[1]});return angular.forEach(s,function(a){angular.forEach(t,function(t){a[0].replace("id_","")===t.post_id.toString()&&o.push(t)})}),o}var embed_controllers=angular.module("embed.controllers",[]);embed_controllers.controller("EmbedCtrl",["$scope","$rootScope","$routeParams","htgUser","htgSession","htgTags","htgPosts","htgGeneral","socialNetworks","postTypes","loggedInUser",function(t,a,e,o,s,n,r,i,l,u,d){var p=e.tag;a.page_icon="tag-icon",a.page={tags:!0,lists:!1,home:!1},t.tag=p=e.tag,t.lazy_store=[],t.posts_status={filterfail:!1,noresults:!1,nomore:!1},t.pfilters={social_network:{},post_type:{}},angular.forEach(l,function(a){t.pfilters.social_network[a]=!1}),angular.forEach(u,function(a){t.pfilters.post_type[a]=!1});var m=[],c=[],g=[],f=null!==$(".htg-container").attr("data-embed-pcount")?$(".htg-container").attr("data-embed-pcount"):20;t.posts=[],t.isPostsLoading=!0,a.post_fullscreen={post_time:new Date,post_type:"",social_network:""};var h,_=(s.get(function(a){t.luserID=h=a.luser_id,t.lstatus=a.lstatus}),{verb:e.tag}),b=(n.getInfo(_,function(t){"owned"===t.data.owned_status?(a.page.official=!0,a.page.owner=t.data.username,a.page.website=t.data.website,a.page.description=t.data.description,a.page.hero_img=t.data.hero_img):a.page.official=!1}),function(e,o){n.getPosts(e,function(e){o&&0===e.data.posts.length?t.posts_status.noresults=!0:(a.post_fullscreen=e.data.posts[0],angular.forEach(e.data.posts,function(t){angular.forEach(l,function(a){t.social_network===a&&$('input[name="'+a+'-max-id"]').val(t.next_results)}),t.post_time=Date.parse(t.post_time),m.push(t),g.push(t)}),g=sortPosts(g,!0),g.length>0?angular.forEach(g,function(a,e){if(f>e){var o=g.shift();t.posts.push(o),c.push(o)}}):t.posts_status.nomore=!0),t.isPostsLoading=!1})}),v={verb:p,limit:f,action:"posts",user_id:d.luser.user_id};"all"!==$(".htg-container").attr("data-embed-platforms")&&(v.advanced_options={platforms:$(".htg-container").attr("data-embed-platforms")}),b(v,!0),t.load_more=function(){ga("send","event","load_more","tags","tag:"+p),t.isPostsLoading=!0,v={verb:p,max_ids:{twitter:{nextIds:$('input[name="twitter-max-id"]').val()},facebook:{nextIds:$('input[name="facebook-max-id"]').val()},instagram:{nextIds:$('input[name="instagram-max-id"]').val()},flickr:{nextIds:$('input[name="flickr-max-id"]').val()},vimeo:{nextIds:$('input[name="vimeo-max-id"]').val()},tumblr:{nextIds:$('input[name="tumblr-max-id"]').val()},youtube:{nextIds:$('input[name="youtube-max-id"]').val()},googleplus:{nextIds:$('input[name="googleplus-max-id"]').val()}},limit:f,action:"posts"},"all"!==$(".htg-container").attr("data-embed-platforms")&&(v.advanced_options={platforms:$(".htg-container").attr("data-embed-platforms")}),b(v,!1)};var x=$(".htg-container").attr("data-embed-theme"),w=["salmon","teal","grey","borderless","hshtags_now","custom_square","custom_outsmartbk"],k="theme_salmon";if(angular.forEach(w,function(t){x===t&&(k=t)}),$("body").addClass("theme_"+k),$(".htg-container").addClass("theme_"+k),("custom_square"===x||"custom_outsmartbk"===x)&&$("body").height("auto"),"borderless"!==x&&"hshtags_now"!==x){var I=$(".embed_wrapper").height();$(".htg-container").find(".embed_wrapper").height(I-85)}}]);